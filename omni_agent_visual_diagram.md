# OmniAgent System Architecture & Flow

## ğŸ—ï¸ System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           OmniAgent System                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   User Input    â”‚    â”‚  OmniAgent      â”‚    â”‚   Response Output       â”‚  â”‚
â”‚  â”‚                 â”‚    â”‚  (Orchestrator) â”‚    â”‚                         â”‚  â”‚
â”‚  â”‚ "Calculate area â”‚â”€â”€â”€â–¶â”‚                 â”‚â”€â”€â”€â–¶â”‚ "The area is 24 sq ft"  â”‚  â”‚
â”‚  â”‚  of 6x4 rect"   â”‚    â”‚                 â”‚    â”‚                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                       â”‚                       â”‚                  â”‚
â”‚           â”‚                       â”‚                       â”‚                  â”‚
â”‚           â–¼                       â–¼                       â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Session Store  â”‚    â”‚  Tool Registry  â”‚    â”‚   Memory Router         â”‚  â”‚
â”‚  â”‚  (Chat History) â”‚    â”‚                 â”‚    â”‚                         â”‚  â”‚
â”‚  â”‚                 â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚ â€¢ Chat ID       â”‚    â”‚  â”‚ Local Tools â”‚â”‚    â”‚  â”‚ In-Memory Store     â”‚â”‚  â”‚
â”‚  â”‚ â€¢ Messages      â”‚    â”‚  â”‚             â”‚â”‚    â”‚  â”‚                     â”‚â”‚  â”‚
â”‚  â”‚ â€¢ Context       â”‚    â”‚  â”‚ â€¢ calculate_â”‚â”‚    â”‚  â”‚ â€¢ Episodic Memory   â”‚â”‚  â”‚
â”‚  â”‚                 â”‚    â”‚  â”‚   area      â”‚â”‚    â”‚  â”‚ â€¢ Working Memory    â”‚â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚ â€¢ get_weatherâ”‚â”‚    â”‚  â”‚ â€¢ Token Budget      â”‚â”‚  â”‚
â”‚                         â”‚  â”‚ â€¢ format_textâ”‚â”‚    â”‚  â”‚                     â”‚â”‚  â”‚
â”‚                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                         â”‚                 â”‚    â”‚                         â”‚  â”‚
â”‚                         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚                         â”‚  â”‚ MCP Tools   â”‚â”‚    â”‚  â”‚ File System MCP     â”‚â”‚  â”‚
â”‚                         â”‚  â”‚             â”‚â”‚    â”‚  â”‚                     â”‚â”‚  â”‚
â”‚                         â”‚  â”‚ â€¢ filesystemâ”‚â”‚    â”‚  â”‚ â€¢ Read/Write Files  â”‚â”‚  â”‚
â”‚                         â”‚  â”‚ â€¢ webcam    â”‚â”‚    â”‚  â”‚ â€¢ Directory Listing â”‚â”‚  â”‚
â”‚                         â”‚  â”‚ â€¢ etc.      â”‚â”‚    â”‚  â”‚ â€¢ File Operations   â”‚â”‚  â”‚
â”‚                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Detailed Flow Process

### 1. **Initialization Phase**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           INITIALIZATION                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. Create Local Tools Registry                                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚ @local_tools.register_tool(                                         â”‚ â”‚
â”‚     â”‚     name="calculate_area",                                          â”‚ â”‚
â”‚     â”‚     description="Calculate area of rectangle",                      â”‚ â”‚
â”‚     â”‚     inputSchema={...}                                               â”‚ â”‚
â”‚     â”‚ )                                                                   â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚  2. Configure OmniAgent                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚ agent = OmniAgent(                                                  â”‚ â”‚
â”‚     â”‚     name="session_agent",                                           â”‚ â”‚
â”‚     â”‚     system_instruction="You are a helpful assistant...",            â”‚ â”‚
â”‚     â”‚     agent_config={...},                                             â”‚ â”‚
â”‚     â”‚     model_config={...},                                             â”‚ â”‚
â”‚     â”‚     mcp_tools=[...],                                                â”‚ â”‚
â”‚     â”‚     local_tools=local_tools,                                        â”‚ â”‚
â”‚     â”‚     memory_store=custom_memory                                      â”‚ â”‚
â”‚     â”‚ )                                                                   â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **Request Processing Flow**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REQUEST PROCESSING FLOW                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  User: "Calculate area of 6x4 rectangle"                                   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚   1. PARSING    â”‚                                                       â”‚
â”‚  â”‚                 â”‚                                                       â”‚
â”‚  â”‚ â€¢ Extract intentâ”‚                                                       â”‚
â”‚  â”‚ â€¢ Identify toolsâ”‚                                                       â”‚
â”‚  â”‚ â€¢ Check context â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚           â”‚                                                               â”‚
â”‚           â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚  2. TOOL CALL   â”‚                                                       â”‚
â”‚  â”‚                 â”‚                                                       â”‚
â”‚  â”‚ <tool_call>     â”‚                                                       â”‚
â”‚  â”‚   <tool_name>   â”‚                                                       â”‚
â”‚  â”‚     calculate_  â”‚                                                       â”‚
â”‚  â”‚     area        â”‚                                                       â”‚
â”‚  â”‚   </tool_name>  â”‚                                                       â”‚
â”‚  â”‚   <parameters>  â”‚                                                       â”‚
â”‚  â”‚     <length>6   â”‚                                                       â”‚
â”‚  â”‚     </length>   â”‚                                                       â”‚
â”‚  â”‚     <width>4    â”‚                                                       â”‚
â”‚  â”‚     </width>    â”‚                                                       â”‚
â”‚  â”‚   </parameters> â”‚                                                       â”‚
â”‚  â”‚ </tool_call>    â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚           â”‚                                                               â”‚
â”‚           â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ 3. EXECUTION    â”‚                                                       â”‚
â”‚  â”‚                 â”‚                                                       â”‚
â”‚  â”‚ â€¢ Validate args â”‚                                                       â”‚
â”‚  â”‚ â€¢ Execute func  â”‚                                                       â”‚
â”‚  â”‚ â€¢ Return result â”‚                                                       â”‚
â”‚  â”‚   (24.0)        â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚           â”‚                                                               â”‚
â”‚           â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚  4. RESPONSE    â”‚                                                       â”‚
â”‚  â”‚                 â”‚                                                       â”‚
â”‚  â”‚ <final_answer>  â”‚                                                       â”‚
â”‚  â”‚ The area of a   â”‚                                                       â”‚
â”‚  â”‚ 6x4 rectangle   â”‚                                                       â”‚
â”‚  â”‚ is 24 square    â”‚                                                       â”‚
â”‚  â”‚ feet.           â”‚                                                       â”‚
â”‚  â”‚ </final_answer> â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. **Memory Management**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           MEMORY MANAGEMENT                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Memory Router                                        â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Working Memory  â”‚  â”‚ Episodic Memory â”‚  â”‚   Token Budget          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Current       â”‚  â”‚ â€¢ Past          â”‚  â”‚ â€¢ Track token usage     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   conversation  â”‚  â”‚   interactions  â”‚  â”‚ â€¢ Enforce limits        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Tool calls    â”‚  â”‚ â€¢ User          â”‚  â”‚ â€¢ Optimize context      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Results       â”‚  â”‚   preferences   â”‚  â”‚                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Context       â”‚  â”‚ â€¢ Effective     â”‚  â”‚                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚   strategies    â”‚  â”‚                         â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ Tool Integration Examples

### Local Tools
```python
# Example: calculate_area tool
@local_tools.register_tool(
    name="calculate_area",
    description="Calculate the area of a rectangle",
    inputSchema={
        "type": "object",
        "properties": {
            "length": {"type": "number"}, 
            "width": {"type": "number"}
        },
        "required": ["length", "width"],
    },
)
def calculate_area(length: float, width: float) -> float:
    return length * width

# Usage in conversation:
# User: "Calculate area of 6x4 rectangle"
# Agent: <tool_call><tool_name>calculate_area</tool_name><parameters><length>6</length><width>4</width></parameters></tool_call>
# Result: 24.0
# Agent: <final_answer>The area is 24 square feet.</final_answer>
```

### MCP Tools
```python
# Example: filesystem MCP tool
mcp_tools=[
    {
        "name": "filesystem",
        "transport_type": "stdio",
        "command": "npx",
        "args": [
            "-y",
            "@modelcontextprotocol/server-filesystem",
            "/home/abiorh/Desktop",
            "/home/abiorh/ai/",
        ],
    }
]

# Usage in conversation:
# User: "List files in my Desktop"
# Agent: <tool_call><tool_name>filesystem_list_directory</tool_name><parameters><path>/home/abiorh/Desktop</path></parameters></tool_call>
# Result: ["file1.txt", "document.pdf", "image.jpg"]
# Agent: <final_answer>Your Desktop contains: file1.txt, document.pdf, and image.jpg</final_answer>
```

## ğŸ”§ Configuration Components

### Agent Configuration
```python
agent_config = {
    "max_steps": 20,              # Maximum tool calls per conversation
    "tool_call_timeout": 60,      # Timeout for tool execution
    "request_limit": 1000,        # Maximum requests per session
    "memory_config": {
        "mode": "token_budget",   # Memory management mode
        "value": 10000           # Token budget limit
    },
}
```

### Model Configuration
```python
model_config = {
    "provider": "gemini",         # LLM provider
    "model": "gemini-2.0-flash",  # Specific model
    "max_context_length": 50000,  # Context window size
}
```

## ğŸ¯ Key Features

1. **Unified Tool Interface**: Seamlessly combines local Python functions and MCP tools
2. **XML-Based Communication**: Structured format for tool calls and responses
3. **Session Management**: Persistent conversation history with chat IDs
4. **Memory Management**: Intelligent context management with token budgeting
5. **Error Handling**: Robust error reporting and recovery
6. **Extensible Architecture**: Easy to add new tools and capabilities

## ğŸ”„ Complete Example Flow

```
User Input: "Calculate area of 6x4 rectangle and save result to a file"

1. Parse Request
   â”œâ”€â”€ Identify tools needed: calculate_area, filesystem_write
   â”œâ”€â”€ Extract parameters: length=6, width=4
   â””â”€â”€ Plan execution order

2. Execute calculate_area
   â”œâ”€â”€ Tool Call: <tool_call><tool_name>calculate_area</tool_name><parameters><length>6</length><width>4</width></parameters></tool_call>
   â”œâ”€â”€ Execution: 6 * 4 = 24
   â””â”€â”€ Result: 24.0

3. Execute filesystem_write
   â”œâ”€â”€ Tool Call: <tool_call><tool_name>filesystem_write_file</tool_name><parameters><path>/home/abiorh/Desktop/area_result.txt</path><contents>Area: 24 square feet</contents></tool_call>
   â”œâ”€â”€ Execution: Write file to Desktop
   â””â”€â”€ Result: File created successfully

4. Generate Response
   â””â”€â”€ <final_answer>I calculated the area of a 6x4 rectangle, which is 24 square feet. I've also saved this result to a file called 'area_result.txt' on your Desktop.</final_answer>
```

This visual representation shows how OmniAgent seamlessly integrates multiple tool types, manages memory, and provides a unified interface for complex multi-step tasks. 